<Window x:Class="VPetLLM.UI.Windows.winSettingNew"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VPetLLM"
    
        mc:Ignorable="d"
        Title="VPetLLM"
    xmlns:utils="clr-namespace:VPetLLM.Utils"
        Height="907"
        Width="1117"
        Background="{DynamicResource BackgroundBrush}">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Styles/Controls.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <utils:BoolInverter x:Key="BoolInverter"/>

            <!-- 现代化TabControl样式 -->
            <Style x:Key="ModernTabControl" TargetType="TabControl">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="0"/>
            </Style>

            <Style x:Key="ModernTabItem" TargetType="TabItem">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="{StaticResource SecondaryTextBrush}"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="Normal"/>
                <Setter Property="Padding" Value="16,12"/>
                <Setter Property="Margin" Value="0,0,2,0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Border Background="{TemplateBinding Background}"
                                    BorderThickness="0,0,0,2"
                                    BorderBrush="Transparent"
                                    CornerRadius="4,4,0,0">
                                <ContentPresenter x:Name="ContentSite"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                ContentSource="Header"
                                                Margin="{TemplateBinding Padding}"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#FFFFFF"/>
                                    <Setter Property="Foreground" Value="#0078D4"/>
                                    <Setter TargetName="ContentSite" Property="TextElement.FontWeight" Value="SemiBold"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#F3F2F1"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- 设置组样式 -->
            <Style x:Key="SettingGroup" TargetType="StackPanel">
                <Setter Property="Margin" Value="0,0,0,20"/>
            </Style>

            <Style x:Key="SettingLabel" TargetType="Label">
                <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="Medium"/>
                <Setter Property="Margin" Value="0,0,0,8"/>
            </Style>

            <!-- 节标题样式 -->
            <Style x:Key="SectionHeader" TargetType="TextBlock">
                <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Margin" Value="0,0,0,12"/>
            </Style>

            <!-- 描述文本样式 -->
            <Style x:Key="DescriptionText" TargetType="TextBlock">
                <Setter Property="Foreground" Value="{StaticResource SecondaryTextBrush}"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
                <Setter Property="LineHeight" Value="18"/>
            </Style>

            <!-- 现代化密码框样式 -->
            <Style x:Key="ModernPasswordBox" TargetType="PasswordBox">
                <Setter Property="Background" Value="{StaticResource ControlBackgroundBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="12,8"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Height" Value="36"/>
            </Style>

            <!-- DataGrid列头样式 -->
            <Style x:Key="ModernDataGridColumnHeader" TargetType="DataGridColumnHeader">
                <Setter Property="Background" Value="{StaticResource ControlBackgroundBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Padding" Value="12,8"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="0,0,1,1"/>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TabControl Grid.Row="0" Style="{StaticResource ModernTabControl}">
            <TabItem Header="{utils:Localize KeyPath=LLM_Settings.Tab}"
                    x:Name="Tab_LLM"
                    Style="{StaticResource ModernTabItem}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <ScrollViewer Grid.Column="0"
                            VerticalScrollBarVisibility="Auto">
                        <Border Style="{StaticResource CardContainer}" Margin="0,0,10,0">
                            <StackPanel Style="{StaticResource SettingGroup}">
                                <Label Content="{utils:Localize KeyPath=LLM_Settings.Provider}"
                                        x:Name="Label_Provider"
                                        Style="{StaticResource SettingLabel}"/>
                                <ComboBox x:Name="ComboBox_Provider"
                                        Margin="0,0,0,16"
                                        SelectionChanged="ComboBox_Provider_SelectionChanged"
                                        Style="{StaticResource ModernComboBox}">
                                    <!-- 简化的ComboBoxItem样式 -->
                                    <ComboBox.ItemContainerStyle>
                                        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource {x:Type ComboBoxItem}}">
                                            <Setter Property="Padding" Value="12,8"/>
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="ContentTemplate">
                                                <Setter.Value>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <!-- 提供商图标 -->
                                                            <Border x:Name="ItemIcon"
                                                                    Background="{StaticResource AccentBrush}"
                                                                    CornerRadius="3"
                                                                    Width="18"
                                                                    Height="18"
                                                                    Margin="0,0,8,0">
                                                                <TextBlock x:Name="ItemIconText"
                                                                        Text="⚡"
                                                                        FontSize="9"
                                                                        Foreground="White"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"/>
                                                            </Border>

                                                            <!-- 提供商名称 -->
                                                            <TextBlock Text="{Binding}"
                                                                    VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                        <DataTemplate.Triggers>
                                                            <!-- 根据不同提供商设置图标 -->
                                                            <DataTrigger Binding="{Binding}" Value="Ollama">
                                                                <Setter TargetName="ItemIconText" Property="Text" Value="O"/>
                                                                <Setter TargetName="ItemIcon" Property="Background" Value="#FF6B35"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding}" Value="OpenAI">
                                                                <Setter TargetName="ItemIconText" Property="Text" Value="AI"/>
                                                                <Setter TargetName="ItemIcon" Property="Background" Value="#10A37F"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding}" Value="Gemini">
                                                                <Setter TargetName="ItemIconText" Property="Text" Value="G"/>
                                                                <Setter TargetName="ItemIcon" Property="Background" Value="#4285F4"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding}" Value="Free">
                                                                <Setter TargetName="ItemIconText" Property="Text" Value="F"/>
                                                                <Setter TargetName="ItemIcon" Property="Background" Value="#28A745"/>
                                                            </DataTrigger>
                                                        </DataTemplate.Triggers>
                                                    </DataTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>

                                <Label Content="{utils:Localize KeyPath=LLM_Settings.AiName}"
                                        VerticalAlignment="Top"
                                        Margin="0,0,0,0"
                                        x:Name="Label_AiName"
                                        Style="{StaticResource SettingLabel}"/>
                                <TextBox x:Name="TextBox_AiName"
                                         MaxWidth="300"
                                         Margin="0,0,0,16"
                                         Style="{StaticResource ModernTextBox}"
                                         IsEnabled="{Binding IsChecked, ElementName=CheckBox_FollowVPetName, Converter={StaticResource BoolInverter}}"/>
                                <Label Content="{utils:Localize KeyPath=LLM_Settings.UserName}"
                                         VerticalAlignment="Top"
                                         Margin="0,0,0,0"
                                         x:Name="Label_UserName"
                                         Style="{StaticResource SettingLabel}"/>
                                <TextBox x:Name="TextBox_UserName"
                                         MaxWidth="300"
                                         Margin="0,0,0,16"
                                         Style="{StaticResource ModernTextBox}"
                                         IsEnabled="{Binding IsChecked, ElementName=CheckBox_FollowVPetName, Converter={StaticResource BoolInverter}}"/>
                                <CheckBox x:Name="CheckBox_FollowVPetName"
                                        Content="{utils:Localize KeyPath=LLM_Settings.FollowVPetName}"
                                        Margin="0,0,0,16"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <Label Content="{utils:Localize KeyPath=LLM_Settings.Role}"
                                        VerticalAlignment="Top"
                                        Margin="0,0,0,0"
                                        x:Name="Label_Role"
                                        Style="{StaticResource SettingLabel}"/>
                                <TextBox x:Name="TextBox_Role"
                                        TextWrapping="Wrap"
                                        AcceptsReturn="True"
                                        VerticalScrollBarVisibility="Auto"
                                        HorizontalScrollBarVisibility="Auto"
                                        Height="120"
                                        Width="300"
                                        Margin="0,0,0,16"
                                        Style="{StaticResource ModernTextBox}"/>

                                <Label Content="{utils:Localize KeyPath=LLM_Settings.ContextControl}"
                                        Margin="0,0,0,0"
                                        x:Name="Label_ContextControl"
                                        Style="{StaticResource SettingLabel}"/>
                                <CheckBox x:Name="CheckBox_KeepContext"
                                        Content="{utils:Localize KeyPath=LLM_Settings.KeepContext}"
                                        Margin="0,0,0,8"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_EnableChatHistory"
                                        Content="{utils:Localize KeyPath=LLM_Settings.EnableChatHistory}"
                                        Margin="0,0,0,8"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_SeparateChatByProvider"
                                        Content="{utils:Localize KeyPath=LLM_Settings.SeparateChatByProvider}"
                                        Margin="0,0,0,16"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <WrapPanel HorizontalAlignment="Right"
                                        Margin="0,0,0,0">
                                    <Button x:Name="Button_ClearContext"
                                            Content="{utils:Localize KeyPath=LLM_Settings.ClearContext}"
                                            Click="Button_ClearContext_Click"
                                            Margin="0,0,10,0"
                                            Style="{StaticResource SecondaryButton}"/>
                                    <Button x:Name="Button_EditContext"
                                            Content="{utils:Localize KeyPath=LLM_Settings.EditContext}"
                                            Click="Button_EditContext_Click"
                                            Style="{StaticResource ModernButton}"/>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>

                    <TabControl Grid.Column="1">
                        <TabItem Header="{utils:Localize KeyPath=Ollama.Header}"
                                x:Name="Tab_Ollama"
                                Style="{StaticResource ModernTabItem}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Border Style="{StaticResource CardContainer}">
                                    <StackPanel Style="{StaticResource SettingGroup}">
                                        <Label Content="{utils:Localize KeyPath=Ollama.URL}"
                                                x:Name="Label_OllamaUrl"
                                                Style="{StaticResource SettingLabel}"/>
                                        <TextBox x:Name="TextBox_OllamaUrl"
                                                Margin="0,0,0,16"
                                                Style="{StaticResource ModernTextBox}"/>
                                        <Label Content="{utils:Localize KeyPath=Ollama.Model}"
                                                x:Name="Label_OllamaModel"
                                                Style="{StaticResource SettingLabel}"/>
                                        <Grid Margin="0,0,0,16">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <ComboBox x:Name="ComboBox_OllamaModel"
                                                    Grid.Column="0"
                                                    IsEditable="True"
                                                    Style="{StaticResource ModelComboBox}"/>
                                            <Button x:Name="Button_RefreshOllamaModels"
                                                    Grid.Column="1"
                                                    Content="{utils:Localize KeyPath=Ollama.Refresh}"
                                                    Click="Button_RefreshOllamaModels_Click"
                                                    Margin="10,0,0,0"
                                                    Style="{StaticResource SecondaryButton}"/>
                                        </Grid>
                                        <CheckBox x:Name="CheckBox_Ollama_EnableStreaming"
                                                Content="{utils:Localize KeyPath=Ollama.EnableStreaming}"
                                                Margin="0,0,0,16"
                                                Style="{StaticResource ModernCheckBox}"/>
                                        <CheckBox x:Name="CheckBox_Ollama_EnableAdvanced"
                                                Content="{utils:Localize KeyPath=Ollama.EnableAdvanced}"
                                                Margin="0,0,0,16"
                                                Style="{StaticResource ModernCheckBox}"/>
                                        <StackPanel x:Name="StackPanel_Ollama_Advanced"
                                                Margin="20,0,0,0"
                                                IsEnabled="{Binding ElementName=CheckBox_Ollama_EnableAdvanced, Path=IsChecked}">
                                            <StackPanel Orientation="Horizontal"
                                                    Margin="0,0,0,12">
                                                <TextBlock Text="{utils:Localize KeyPath=Ollama.Temperature, Suffix=:}"
                                                        Width="80"
                                                        VerticalAlignment="Center"
                                                        x:Name="TextBlock_Ollama_Temperature"
                                                        Foreground="{StaticResource PrimaryTextBrush}"
                                                        FontSize="14"/>
                                                <Slider x:Name="Slider_Ollama_Temperature"
                                                        Minimum="0"
                                                        Maximum="2"
                                                        Width="125"
                                                        Margin="10,0"
                                                        VerticalAlignment="Center"/>
                                                <TextBlock x:Name="TextBlock_Ollama_TemperatureValue"
                                                        Width="40"
                                                        VerticalAlignment="Center"
                                                        Foreground="{StaticResource SecondaryTextBrush}"
                                                        FontSize="14"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                    Margin="0,0,0,0">
                                                <TextBlock Text="{utils:Localize KeyPath=Ollama.MaxTokens, Suffix=:}"
                                                        Width="80"
                                                        VerticalAlignment="Center"
                                                        x:Name="TextBlock_Ollama_MaxTokens"
                                                        Foreground="{StaticResource PrimaryTextBrush}"
                                                        FontSize="14"/>
                                                <TextBox x:Name="TextBox_Ollama_MaxTokens"
                                                        Width="125"
                                                        Margin="10,0"
                                                        VerticalAlignment="Center"
                                                        Style="{StaticResource ModernTextBox}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </ScrollViewer>
                        </TabItem>
                        <TabItem Header="{utils:Localize KeyPath=OpenAI.Header}"
                                x:Name="Tab_OpenAI"
                                Style="{StaticResource ModernTabItem}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Border Style="{StaticResource CardContainer}">
                                    <StackPanel Style="{StaticResource SettingGroup}">
                                        <Label Content="{utils:Localize KeyPath=OpenAI.ChannelManagement}"
                                                x:Name="Label_OpenAINodeManagement"
                                                Style="{StaticResource SettingLabel}"
                                                FontSize="16"
                                                FontWeight="Bold"/>
                                        <TextBlock Text="{utils:Localize KeyPath=OpenAI.ChannelManagementDesc}"
                                                TextWrapping="Wrap"
                                                Foreground="{StaticResource SecondaryTextBrush}"
                                                Margin="0,0,0,16"
                                                FontSize="12"/>

                                        <CheckBox x:Name="CheckBox_OpenAI_EnableLoadBalancing"
                                                Content="{utils:Localize KeyPath=OpenAI.EnableLoadBalancing}"
                                                Margin="0,0,0,16"
                                                IsChecked="True"
                                                Style="{StaticResource ModernCheckBox}"/>

                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                            <Button x:Name="Button_AddOpenAINode"
                                                    Content="{utils:Localize KeyPath=OpenAI.AddChannel}"
                                                    Click="Button_AddOpenAINode_Click"
                                                    Style="{StaticResource ModernButton}"/>
                                            <Button x:Name="Button_RemoveOpenAINode"
                                                    Content="{utils:Localize KeyPath=OpenAI.RemoveSelectedChannel}"
                                                    Click="Button_RemoveOpenAINode_Click"
                                                    Margin="10,0,0,0"
                                                    Style="{StaticResource SecondaryButton}"/>
                                        </StackPanel>

                                        <ListView x:Name="ListView_OpenAINodes"
                                                  Height="200"
                                                  Margin="0,0,0,16"
                                                  SelectionMode="Single"
                                                  SelectionChanged="ListView_OpenAINodes_SelectionChanged">
                                            <ListView.View>
                                                <GridView>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=OpenAI.Enabled}" Width="50">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <CheckBox IsChecked="{Binding Enabled}" 
                                                                          HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=OpenAI.ChannelName}" Width="120" DisplayMemberBinding="{Binding Name}"/>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=OpenAI.ApiKey}" Width="200">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <PasswordBox utils:PasswordBoxHelper.BoundPassword="{Binding ApiKey, Mode=TwoWay}"
                                                                            PasswordChar="*"
                                                                            BorderThickness="0"
                                                                            Background="Transparent"
                                                                            IsEnabled="False"/>
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=OpenAI.Model}" Width="120" DisplayMemberBinding="{Binding Model}"/>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=OpenAI.ApiAddress}" Width="150" DisplayMemberBinding="{Binding Url}"/>
                                                </GridView>
                                            </ListView.View>
                                        </ListView>

                                        <StackPanel x:Name="StackPanel_OpenAINodeDetails"
                                                Margin="20,0,0,16"
                                                IsEnabled="{Binding ElementName=ListView_OpenAINodes, Path=SelectedItem}">
                                            <Label Content="{utils:Localize KeyPath=OpenAI.ChannelConfig}"
                                                    Style="{StaticResource SettingLabel}"
                                                    FontSize="14"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <Label Content="{utils:Localize KeyPath=OpenAI.ChannelName, Suffix=:}"
                                                        Grid.Row="0" Grid.Column="0"
                                                        Style="{StaticResource SettingLabel}"/>
                                                <TextBox x:Name="TextBox_OpenAINodeName"
                                                        Grid.Row="0" Grid.Column="1"
                                                        Margin="10,0,0,8"
                                                        Style="{StaticResource ModernTextBox}"/>

                                                <Label Content="{utils:Localize KeyPath=OpenAI.ApiKey, Suffix=:}"
                                                        Grid.Row="1" Grid.Column="0"
                                                        Style="{StaticResource SettingLabel}"/>
                                                <Grid Grid.Row="1" Grid.Column="1" Margin="10,0,0,8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <PasswordBox x:Name="PasswordBox_OpenAIApiKey"
                                                                 Grid.Column="0"
                                                                 PasswordChar="*"/>
                                                    <TextBox x:Name="TextBox_OpenAIApiKey_Plain"
                                                             Grid.Column="0"
                                                             Visibility="Collapsed"
                                                             AcceptsReturn="True"
                                                             TextWrapping="Wrap"
                                                             VerticalScrollBarVisibility="Auto"
                                                             Height="80"
                                                             ToolTip="{utils:Localize KeyPath=OpenAI.ApiKeyTooltip}"
                                                             FontFamily="Consolas"
                                                             Style="{StaticResource ModernTextBox}"/>
                                                    <Button x:Name="Button_Toggle_OpenAIApiKey"
                                                            Grid.Column="1"
                                                            Content="👁"
                                                            ToolTip="{utils:Localize KeyPath=OpenAI.ToggleApiKeyVisibility}"
                                                            Click="Button_Toggle_OpenAIApiKey_Click"
                                                            Margin="8,0,0,0"
                                                            Style="{StaticResource SecondaryButton}"/>
                                                </Grid>

                                                <Label Content="{utils:Localize KeyPath=OpenAI.Model, Suffix=:}"
                                                        Grid.Row="2" Grid.Column="0"
                                                        Style="{StaticResource SettingLabel}"/>
                                                <Grid Grid.Row="2" Grid.Column="1" Margin="10,0,0,8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <ComboBox x:Name="ComboBox_OpenAIModel"
                                                            Grid.Column="0"
                                                            IsEditable="True"
                                                            Style="{StaticResource ModelComboBox}"/>
                                                    <Button x:Name="Button_RefreshOpenAIModels"
                                                            Grid.Column="1"
                                                            Content="{utils:Localize KeyPath=OpenAI.Refresh}"
                                                            Click="Button_RefreshOpenAIModels_Click"
                                                            Margin="10,0,0,0"
                                                            Style="{StaticResource SecondaryButton}"/>
                                                </Grid>

                                                <Label Content="{utils:Localize KeyPath=OpenAI.ApiAddress, Suffix=:}"
                                                        Grid.Row="3" Grid.Column="0"
                                                        Style="{StaticResource SettingLabel}"/>
                                                <TextBox x:Name="TextBox_OpenAIUrl"
                                                        Grid.Row="3" Grid.Column="1"
                                                        Margin="10,0,0,8"
                                                        Style="{StaticResource ModernTextBox}"/>
                                            </Grid>

                                            <CheckBox x:Name="CheckBox_OpenAI_EnableStreaming"
                                                    Content="{utils:Localize KeyPath=OpenAI.EnableStreaming}"
                                                    Margin="0,16,0,16"
                                                    Style="{StaticResource ModernCheckBox}"/>
                                            <CheckBox x:Name="CheckBox_OpenAI_EnableAdvanced"
                                                    Content="{utils:Localize KeyPath=OpenAI.EnableAdvanced}"
                                                    Margin="0,0,0,16"
                                                    Style="{StaticResource ModernCheckBox}"/>
                                            <StackPanel x:Name="StackPanel_OpenAI_Advanced"
                                                    Margin="20,0,0,0"
                                                    IsEnabled="{Binding ElementName=CheckBox_OpenAI_EnableAdvanced, Path=IsChecked}">
                                                <StackPanel Orientation="Horizontal"
                                                        Margin="0,0,0,12">
                                                    <TextBlock Text="{utils:Localize KeyPath=OpenAI.Temperature}"
                                                            Width="80"
                                                            VerticalAlignment="Center"
                                                            x:Name="TextBlock_OpenAI_Temperature"
                                                            Foreground="{StaticResource PrimaryTextBrush}"
                                                            FontSize="14"/>
                                                    <Slider x:Name="Slider_OpenAI_Temperature"
                                                            Minimum="0"
                                                            Maximum="2"
                                                            Width="125"
                                                            Margin="10,0"
                                                            VerticalAlignment="Center"/>
                                                    <TextBlock x:Name="TextBlock_OpenAI_TemperatureValue"
                                                            Width="40"
                                                            VerticalAlignment="Center"
                                                            Foreground="{StaticResource SecondaryTextBrush}"
                                                            FontSize="14"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal"
                                                        Margin="0,0,0,0">
                                                    <TextBlock Text="{utils:Localize KeyPath=OpenAI.MaxTokens}"
                                                            Width="80"
                                                            VerticalAlignment="Center"
                                                            x:Name="TextBlock_OpenAI_MaxTokens"
                                                            Foreground="{StaticResource PrimaryTextBrush}"
                                                            FontSize="14"/>
                                                    <TextBox x:Name="TextBox_OpenAI_MaxTokens"
                                                            Width="125"
                                                            Margin="10,0"
                                                            VerticalAlignment="Center"
                                                            Style="{StaticResource ModernTextBox}"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </ScrollViewer>
                        </TabItem>
                        <TabItem Header="{utils:Localize KeyPath=Gemini.Header}"
                                x:Name="Tab_Gemini"
                                Style="{StaticResource ModernTabItem}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Border Style="{StaticResource CardContainer}">
                                    <StackPanel Style="{StaticResource SettingGroup}">
                                        <!-- Gemini 节点管理（新增） -->
                                        <Label Content="{utils:Localize KeyPath=Gemini.ChannelManagement}"
                                               x:Name="Label_GeminiNodeManagement"
                                               Style="{StaticResource SettingLabel}"
                                               FontSize="16"
                                               FontWeight="Bold"/>
                                        <TextBlock Text="{utils:Localize KeyPath=Gemini.ChannelManagementDesc}"
                                                   TextWrapping="Wrap"
                                                   Foreground="{StaticResource SecondaryTextBrush}"
                                                   Margin="0,0,0,16"
                                                   FontSize="12"/>
                                        <CheckBox x:Name="CheckBox_Gemini_EnableLoadBalancing"
                                                  Content="{utils:Localize KeyPath=Gemini.EnableLoadBalancing}"
                                                  Margin="0,0,0,16"
                                                  IsChecked="True"
                                                  Style="{StaticResource ModernCheckBox}"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                            <Button x:Name="Button_AddGeminiNode"
                                                    Content="{utils:Localize KeyPath=Gemini.AddChannel}"
                                                    Click="Button_AddGeminiNode_Click"
                                                    Style="{StaticResource ModernButton}"/>
                                            <Button x:Name="Button_RemoveGeminiNode"
                                                    Content="{utils:Localize KeyPath=Gemini.RemoveSelectedChannel}"
                                                    Click="Button_RemoveGeminiNode_Click"
                                                    Margin="10,0,0,0"
                                                    Style="{StaticResource SecondaryButton}"
                                                    />
                                        </StackPanel>
                                        <ListView x:Name="ListView_GeminiNodes"
                                                  Height="200"
                                                  Margin="0,0,0,16"
                                                  SelectionMode="Single"
                                                  SelectionChanged="ListView_GeminiNodes_SelectionChanged">
                                            <ListView.View>
                                                <GridView>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=Gemini.Enabled}" Width="50">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <CheckBox IsChecked="{Binding Enabled}"
                                                                          HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=Gemini.ChannelName}" Width="120" DisplayMemberBinding="{Binding Name}"/>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=Gemini.ApiKey}" Width="200">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <PasswordBox utils:PasswordBoxHelper.BoundPassword="{Binding ApiKey, Mode=TwoWay}"
                                                                             PasswordChar="*"
                                                                             BorderThickness="0"
                                                                             Background="Transparent"
                                                                             IsEnabled="False"/>
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=Gemini.Model}" Width="120" DisplayMemberBinding="{Binding Model}"/>
                                                    <GridViewColumn Header="{utils:Localize KeyPath=Gemini.ApiAddress}" Width="150" DisplayMemberBinding="{Binding Url}"/>
                                                </GridView>
                                            </ListView.View>
                                        </ListView>
                                        <StackPanel x:Name="StackPanel_GeminiNodeDetails"
                                                    Margin="20,0,0,16"
                                                    IsEnabled="{Binding ElementName=ListView_GeminiNodes, Path=SelectedItem}">
                                            <Label Content="{utils:Localize KeyPath=Gemini.ChannelConfig}"
                                                   Style="{StaticResource SettingLabel}"
                                                   FontSize="14"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <Label Content="{utils:Localize KeyPath=Gemini.ChannelName, Suffix=:}"
                                                       Grid.Row="0" Grid.Column="0"
                                                       Style="{StaticResource SettingLabel}"/>
                                                <TextBox x:Name="TextBox_GeminiNodeName"
                                                         Grid.Row="0" Grid.Column="1"
                                                         Margin="10,0,0,8"
                                                         Style="{StaticResource ModernTextBox}"/>
                                                <Label Content="{utils:Localize KeyPath=Gemini.ApiKey, Suffix=:}"
                                                       Grid.Row="1" Grid.Column="0"
                                                       Style="{StaticResource SettingLabel}"/>
                                                <Grid Grid.Row="1" Grid.Column="1" Margin="10,0,0,8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <PasswordBox x:Name="PasswordBox_GeminiApiKey"
                                                                 Grid.Column="0"
                                                                 PasswordChar="*"/>
                                                    <TextBox x:Name="TextBox_GeminiApiKey_Plain"
                                                             Grid.Column="0"
                                                             Visibility="Collapsed"
                                                             AcceptsReturn="True"
                                                             TextWrapping="Wrap"
                                                             VerticalScrollBarVisibility="Auto"
                                                             Height="80"
                                                             ToolTip="{utils:Localize KeyPath=Gemini.ApiKeyTooltip}"
                                                             FontFamily="Consolas"
                                                             Style="{StaticResource ModernTextBox}"/>
                                                    <Button x:Name="Button_Toggle_GeminiApiKey"
                                                            Grid.Column="1"
                                                            Content="👁"
                                                            ToolTip="{utils:Localize KeyPath=Gemini.ToggleApiKeyVisibility}"
                                                            Click="Button_Toggle_GeminiApiKey_Click"
                                                            Margin="8,0,0,0"
                                                            Style="{StaticResource SecondaryButton}"/>
                                                </Grid>
                                                <Label Content="{utils:Localize KeyPath=Gemini.Model, Suffix=:}"
                                                       Grid.Row="2" Grid.Column="0"
                                                       Style="{StaticResource SettingLabel}"/>
                                                <Grid Grid.Row="2" Grid.Column="1" Margin="10,0,0,8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <ComboBox x:Name="ComboBox_GeminiNodeModel"
                                                              Grid.Column="0"
                                                              IsEditable="True"
                                                              Style="{StaticResource ModelComboBox}"/>
                                                    <Button x:Name="Button_RefreshGeminiModels_Nodes"
                                                            Grid.Column="1"
                                                            Content="{utils:Localize KeyPath=Gemini.Refresh}"
                                                            Click="Button_RefreshGeminiModels_Click"
                                                            Margin="10,0,0,0"
                                                            Style="{StaticResource SecondaryButton}"/>
                                                </Grid>
                                                <Label Content="{utils:Localize KeyPath=Gemini.ApiAddress, Suffix=:}"
                                                       Grid.Row="3" Grid.Column="0"
                                                       Style="{StaticResource SettingLabel}"/>
                                                <TextBox x:Name="TextBox_GeminiNodeUrl"
                                                         Grid.Row="3" Grid.Column="1"
                                                         Margin="10,0,0,8"
                                                         Style="{StaticResource ModernTextBox}"/>
                                            </Grid>
                                            <CheckBox x:Name="CheckBox_GeminiNode_EnableStreaming"
                                                      Content="{utils:Localize KeyPath=Gemini.EnableStreaming}"
                                                      Margin="0,16,0,16"
                                                      Style="{StaticResource ModernCheckBox}"/>
                                            <CheckBox x:Name="CheckBox_GeminiNode_EnableAdvanced"
                                                      Content="{utils:Localize KeyPath=Gemini.EnableAdvanced}"
                                                      Margin="0,0,0,16"
                                                      Style="{StaticResource ModernCheckBox}"/>
                                            <StackPanel x:Name="StackPanel_GeminiNode_Advanced"
                                                        Margin="20,0,0,0"
                                                        IsEnabled="{Binding ElementName=CheckBox_GeminiNode_EnableAdvanced, Path=IsChecked}">
                                                <StackPanel Orientation="Horizontal"
                                                            Margin="0,0,0,12">
                                                    <TextBlock Text="{utils:Localize KeyPath=Gemini.Temperature}"
                                                               Width="80"
                                                               VerticalAlignment="Center"
                                                               Foreground="{StaticResource PrimaryTextBrush}"
                                                               FontSize="14"/>
                                                    <Slider x:Name="Slider_GeminiNode_Temperature"
                                                            Minimum="0"
                                                            Maximum="2"
                                                            Width="125"
                                                            Margin="10,0"
                                                            VerticalAlignment="Center"/>
                                                    <TextBlock x:Name="TextBlock_GeminiNode_TemperatureValue"
                                                               Width="40"
                                                               VerticalAlignment="Center"
                                                               Foreground="{StaticResource SecondaryTextBrush}"
                                                               FontSize="14"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal"
                                                            Margin="0,0,0,0">
                                                    <TextBlock Text="{utils:Localize KeyPath=Gemini.MaxTokens}"
                                                               Width="80"
                                                               VerticalAlignment="Center"
                                                               Foreground="{StaticResource PrimaryTextBrush}"
                                                               FontSize="14"/>
                                                    <TextBox x:Name="TextBox_GeminiNode_MaxTokens"
                                                             Width="125"
                                                             Margin="10,0"
                                                             VerticalAlignment="Center"
                                                             Style="{StaticResource ModernTextBox}"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>


                                    </StackPanel>
                                </Border>
                            </ScrollViewer>
                        </TabItem>
                        <TabItem Header="{utils:Localize KeyPath=Free.Header}"
                                x:Name="Tab_Free"
                                Style="{StaticResource ModernTabItem}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <Border Style="{StaticResource CardContainer}">
                                    <StackPanel Style="{StaticResource SettingGroup}">

                                        <CheckBox x:Name="CheckBox_Free_EnableStreaming"
                                                Content="{utils:Localize KeyPath=Free.EnableStreaming}"
                                                Margin="0,0,0,16"
                                                Style="{StaticResource ModernCheckBox}"/>
                                        <CheckBox x:Name="CheckBox_Free_EnableAdvanced"
                                                Content="{utils:Localize KeyPath=Free.EnableAdvanced}"
                                                Margin="0,0,0,16"
                                                Style="{StaticResource ModernCheckBox}"/>
                                        <StackPanel x:Name="StackPanel_Free_Advanced"
                                                Margin="20,0,0,0"
                                                IsEnabled="{Binding ElementName=CheckBox_Free_EnableAdvanced, Path=IsChecked}">
                                            <StackPanel Orientation="Horizontal"
                                                    Margin="0,0,0,12">
                                                <TextBlock Text="{utils:Localize KeyPath=Free.Temperature, Suffix=:}"
                                                        Width="80"
                                                        VerticalAlignment="Center"
                                                        x:Name="TextBlock_Free_Temperature"
                                                        Foreground="{StaticResource PrimaryTextBrush}"
                                                        FontSize="14"/>
                                                <Slider x:Name="Slider_Free_Temperature"
                                                        Minimum="0"
                                                        Maximum="2"
                                                        Width="125"
                                                        Margin="10,0"
                                                        VerticalAlignment="Center"/>
                                                <TextBlock x:Name="TextBlock_Free_TemperatureValue"
                                                        Width="40"
                                                        VerticalAlignment="Center"
                                                        Foreground="{StaticResource SecondaryTextBrush}"
                                                        FontSize="14"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                    Margin="0,0,0,0">
                                                <TextBlock Text="{utils:Localize KeyPath=Free.MaxTokens, Suffix=:}"
                                                        Width="80"
                                                        VerticalAlignment="Center"
                                                        x:Name="TextBlock_Free_MaxTokens"
                                                        Foreground="{StaticResource PrimaryTextBrush}"
                                                        FontSize="14"/>
                                                <TextBox x:Name="TextBox_Free_MaxTokens"
                                                        Width="125"
                                                        Margin="10,0"
                                                        VerticalAlignment="Center"
                                                        Style="{StaticResource ModernTextBox}"/>
                                            </StackPanel>
                                            <TextBlock x:Name="TextBlock_ApiServiceNotice" Foreground="{StaticResource SecondaryTextBrush}" FontSize="12" TextWrapping="Wrap" Margin="0,8,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <TabItem Header="{utils:Localize KeyPath=Proxy.Tab}"
                    x:Name="Tab_Proxy"
                    Style="{StaticResource ModernTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Border Style="{StaticResource CardContainer}">
                        <StackPanel Style="{StaticResource SettingGroup}">
                            <CheckBox x:Name="CheckBox_Proxy_IsEnabled"
                                    Content="{utils:Localize KeyPath=Proxy.EnableProxy}"
                                    Margin="0,0,0,16"
                                    Style="{StaticResource ModernCheckBox}"/>
                            <StackPanel Margin="20,0,0,0"
                                    IsEnabled="{Binding ElementName=CheckBox_Proxy_IsEnabled, Path=IsChecked}">
                                <CheckBox x:Name="CheckBox_Proxy_FollowSystemProxy"
                                        Content="{utils:Localize KeyPath=Proxy.FollowSystemProxy}"
                                        Margin="0,0,0,16"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <StackPanel IsEnabled="{Binding ElementName=CheckBox_Proxy_FollowSystemProxy, Path=IsChecked, Converter={StaticResource BoolInverter}}">
                                    <Label Content="{utils:Localize KeyPath=Proxy.Protocol}"
                                            x:Name="Label_Proxy_Protocol"
                                            Style="{StaticResource SettingLabel}"/>
                                    <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,16">
                                        <RadioButton x:Name="RadioButton_Proxy_Http"
                                                Content="{utils:Localize KeyPath=Proxy.Http}"
                                                GroupName="ProxyProtocol"
                                                IsChecked="True"
                                                Style="{StaticResource ModernRadioButton}"/>
                                        <RadioButton x:Name="RadioButton_Proxy_Socks"
                                                Content="{utils:Localize KeyPath=Proxy.Socks5}"
                                                GroupName="ProxyProtocol"
                                                Margin="20,0,0,0"
                                                Style="{StaticResource ModernRadioButton}"/>
                                    </StackPanel>
                                    <Label Content="{utils:Localize KeyPath=Proxy.ProxyAddress}"
                                            x:Name="Label_Proxy_Address"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_Proxy_Address"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>
                                </StackPanel>
                                <Label Content="{utils:Localize KeyPath=Proxy.ProxyScope}"
                                        Margin="0,8,0,0"
                                        x:Name="Label_Proxy_Scope"
                                        Style="{StaticResource SettingLabel}"/>
                                <CheckBox x:Name="CheckBox_Proxy_ForAllAPI"
                                        Content="{utils:Localize KeyPath=Proxy.ForAllAPI}"
                                        Margin="0,0,0,12"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <StackPanel Margin="20,0,0,0"
                                        IsEnabled="{Binding ElementName=CheckBox_Proxy_ForAllAPI, Path=IsChecked, Converter={StaticResource BoolInverter}}">
                                    <CheckBox x:Name="CheckBox_Proxy_ForOllama"
                                            Content="{utils:Localize KeyPath=Proxy.ForOllama}"
                                            Margin="0,0,0,8"
                                            IsChecked="True"
                                            Style="{StaticResource ModernCheckBox}"/>
                                    <CheckBox x:Name="CheckBox_Proxy_ForOpenAI"
                                            Content="{utils:Localize KeyPath=Proxy.ForOpenAI}"
                                            Margin="0,0,0,8"
                                            IsChecked="True"
                                            Style="{StaticResource ModernCheckBox}"/>
                                    <CheckBox x:Name="CheckBox_Proxy_ForGemini"
                                            Content="{utils:Localize KeyPath=Proxy.ForGemini}"
                                            Margin="0,0,0,8"
                                            IsChecked="True"
                                            Style="{StaticResource ModernCheckBox}"/>
                                    <CheckBox x:Name="CheckBox_Proxy_ForFree"
                                            Content="{utils:Localize KeyPath=Proxy.ForFree}"
                                            Margin="0,0,0,8"
                                            IsChecked="True"
                                            Style="{StaticResource ModernCheckBox}"/>
                                </StackPanel>
                                <CheckBox x:Name="CheckBox_Proxy_ForTTS"
                                        Content="{utils:Localize KeyPath=Proxy.ForTTS}"
                                        Margin="0,0,0,12"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_Proxy_ForASR"
                                        Content="{utils:Localize KeyPath=Proxy.ForASR}"
                                        Margin="0,0,0,12"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_Proxy_ForMcp"
                                        Content="{utils:Localize KeyPath=Proxy.ForMcp}"
                                        Margin="0,0,0,8"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_Proxy_ForPlugin"
                                        Content="{utils:Localize KeyPath=Proxy.ForPlugin}"
                                        Margin="0,0,0,16"
                                        IsChecked="True"
                                        Style="{StaticResource ModernCheckBox}"/>

                                <!-- 插件商店代理设置 - 独立区域 -->
                                <Label Content="{utils:Localize KeyPath=PluginStore.ProxySettings}"
                                        Margin="0,16,0,0"
                                        x:Name="Label_PluginStore_Proxy"
                                        Style="{StaticResource SettingLabel}"/>
                                <CheckBox x:Name="CheckBox_PluginStore_UseProxy"
                                        Content="{utils:Localize KeyPath=PluginStore.EnableProxy}"
                                        Margin="0,0,0,12"
                                        IsChecked="True"
                                        IsEnabled="{Binding ElementName=CheckBox_Proxy_IsEnabled, Path=IsChecked}"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <StackPanel Margin="20,0,0,0"
                                        IsEnabled="{Binding ElementName=CheckBox_PluginStore_UseProxy, Path=IsChecked}">
                                    <Label Content="{utils:Localize KeyPath=PluginStore.ProxyUrl}"
                                            x:Name="Label_PluginStore_ProxyUrl"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_PluginStore_ProxyUrl"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="{utils:Localize KeyPath=PluginStore.ProxyUrlNote}"
                                            TextWrapping="Wrap"
                                            Foreground="{StaticResource SecondaryTextBrush}"
                                            x:Name="TextBlock_PluginStore_ProxyUrlNote"
                                            FontSize="12"
                                            Margin="0,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="{utils:Localize KeyPath=Voice.Tab}"
                    x:Name="Tab_Voice"
                    Style="{StaticResource ModernTabItem}">
                <TabControl Style="{StaticResource ModernTabControl}">
                    <!-- TTS 子标签页 -->
                    <TabItem Header="{utils:Localize KeyPath=TTS.Tab}"
                            x:Name="Tab_TTS"
                            Style="{StaticResource ModernTabItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <ScrollViewer Grid.Column="0"
                                    VerticalScrollBarVisibility="Auto">
                                <Border Style="{StaticResource CardContainer}" Margin="0,0,10,0">
                                    <StackPanel Style="{StaticResource SettingGroup}">
                                        <CheckBox x:Name="CheckBox_TTS_IsEnabled"
                                        Content="{utils:Localize KeyPath=TTS.Enable}"
                                        Margin="0,0,0,16"
                                        Style="{StaticResource ModernCheckBox}"/>

                                <StackPanel IsEnabled="{Binding ElementName=CheckBox_TTS_IsEnabled, Path=IsChecked}">
                                    <Label Content="{utils:Localize KeyPath=TTS.Provider}"
                                            x:Name="Label_TTS_Provider"
                                            Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_Provider"
                                            Margin="0,0,0,16"
                                            SelectionChanged="ComboBox_TTS_Provider_SelectionChanged"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="URL" Tag="URL" IsSelected="True"/>
                                        <ComboBoxItem Content="OpenAI" Tag="OpenAI"/>
                                        <ComboBoxItem Content="DIY" Tag="DIY"/>
                                        <ComboBoxItem Content="GPT-SoVITS" Tag="GPT-SoVITS"/>
                                        <ComboBox.ItemContainerStyle>
                                            <Style TargetType="ComboBoxItem" BasedOn="{StaticResource {x:Type ComboBoxItem}}">
                                                <Setter Property="Padding" Value="12,8"/>
                                                <Setter Property="FontSize" Value="14"/>
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Border x:Name="ItemIcon"
                                                                        Background="{StaticResource AccentBrush}"
                                                                        CornerRadius="3"
                                                                        Width="18"
                                                                        Height="18"
                                                                        Margin="0,0,8,0">
                                                                    <TextBlock x:Name="ItemIconText"
                                                                            Text="🔊"
                                                                            FontSize="9"
                                                                            Foreground="White"
                                                                            HorizontalAlignment="Center"
                                                                            VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="{Binding}"
                                                                        VerticalAlignment="Center"/>
                                                            </StackPanel>
                                                            <DataTemplate.Triggers>
                                                                <DataTrigger Binding="{Binding}" Value="URL">
                                                                    <Setter TargetName="ItemIconText" Property="Text" Value="🌐"/>
                                                                    <Setter TargetName="ItemIcon" Property="Background" Value="#FF6B35"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding}" Value="OpenAI">
                                                                    <Setter TargetName="ItemIconText" Property="Text" Value="AI"/>
                                                                    <Setter TargetName="ItemIcon" Property="Background" Value="#10A37F"/>
                                                                </DataTrigger>
                                                            </DataTemplate.Triggers>
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </ComboBox.ItemContainerStyle>
                                    </ComboBox>

                                    <CheckBox x:Name="CheckBox_TTS_OnlyPlayAIResponse"
                                            Content="{utils:Localize KeyPath=TTS.OnlyPlayAIResponse}"
                                            Margin="0,0,0,16"
                                            IsChecked="True"
                                            Style="{StaticResource ModernCheckBox}"/>

                                    <CheckBox x:Name="CheckBox_TTS_UseQueueDownload"
                                            Content="{utils:Localize KeyPath=TTS.UseQueueDownload}"
                                            Margin="0,0,0,16"
                                            IsChecked="False"
                                            Style="{StaticResource ModernCheckBox}"/>

                                    <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,12">
                                        <TextBlock Text="{utils:Localize KeyPath=TTS.Volume, Suffix=:}"
                                                Width="80"
                                                VerticalAlignment="Center"
                                                x:Name="TextBlock_TTS_Volume"
                                                Foreground="{StaticResource PrimaryTextBrush}"
                                                FontSize="14"/>
                                        <Slider x:Name="Slider_TTS_Volume"
                                                Minimum="0"
                                                Maximum="10"
                                                Value="1"
                                                Width="125"
                                                Margin="10,0"
                                                VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TextBlock_TTS_VolumeValue"
                                                Width="40"
                                                VerticalAlignment="Center"
                                                Foreground="{StaticResource SecondaryTextBrush}"
                                                FontSize="14"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,12">
                                        <TextBlock Width="80"
                                                VerticalAlignment="Center"
                                                x:Name="TextBlock_TTS_VolumeGain"
                                                Foreground="{StaticResource PrimaryTextBrush}"
                                                FontSize="14"/>
                                        <Slider x:Name="Slider_TTS_VolumeGain"
                                                Minimum="-20"
                                                Maximum="40"
                                                Value="0"
                                                Width="125"
                                                Margin="10,0"
                                                VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TextBlock_TTS_VolumeGainValue"
                                                Width="50"
                                                VerticalAlignment="Center"
                                                Foreground="{StaticResource SecondaryTextBrush}"
                                                FontSize="14"/>
                                        <TextBlock Text="dB"
                                                VerticalAlignment="Center"
                                                Foreground="{StaticResource SecondaryTextBrush}"
                                                FontSize="12"
                                                Margin="2,0,0,0"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,16">
                                        <TextBlock Text="{utils:Localize KeyPath=TTS.Speed, Suffix=:}"
                                                Width="80"
                                                VerticalAlignment="Center"
                                                x:Name="TextBlock_TTS_Speed"
                                                Foreground="{StaticResource PrimaryTextBrush}"
                                                FontSize="14"/>
                                        <Slider x:Name="Slider_TTS_Speed"
                                                Minimum="0.5"
                                                Maximum="2.0"
                                                Value="1"
                                                Width="125"
                                                Margin="10,0"
                                                VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TextBlock_TTS_SpeedValue"
                                                Width="40"
                                                VerticalAlignment="Center"
                                                Foreground="{StaticResource SecondaryTextBrush}"
                                                FontSize="14"/>
                                    </StackPanel>

                                    <WrapPanel HorizontalAlignment="Right" Margin="0,0,0,0">
                                        <Button x:Name="Button_TTS_Test"
                                                Click="Button_TTS_Test_Click"
                                                Style="{StaticResource ModernButton}"/>
                                    </WrapPanel>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>

                    <ScrollViewer Grid.Column="1"
                            VerticalScrollBarVisibility="Auto">
                        <Border Style="{StaticResource CardContainer}">
                            <StackPanel Style="{StaticResource SettingGroup}">
                                <!-- URL TTS 配置 -->
                                <StackPanel x:Name="Panel_TTS_URL"
                                        Visibility="Visible">
                                    <TextBlock x:Name="TextBlock_TTS_URL_Config"
                                            Text="URL TTS 配置"
                                            Style="{StaticResource SectionHeader}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_TTS_URL_BaseUrl"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_URL_BaseUrl"
                                            Text="https://www.example.com"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label x:Name="Label_TTS_URL_Voice"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_URL_Voice"
                                            Text="36"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="请输入语音模型ID，用于切换不同的语音模型（如：36为女声1，37为男声1等）"
                                            x:Name="TextBlock_TTS_URL_Voice_Tip"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_TTS_URL_RequestMethod"
                                            Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_URL_RequestMethod"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="GET" Tag="GET" IsSelected="True"/>
                                        <ComboBoxItem Content="POST" Tag="POST"/>
                                    </ComboBox>

                                    <TextBlock Text="URL TTS支持GET和POST请求方法，支持多种语音类型。"
                                            x:Name="TextBlock_TTS_URL_Description"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>
                                </StackPanel>

                                <!-- OpenAI TTS 配置 -->
                                <StackPanel x:Name="Panel_TTS_OpenAI"
                                        Visibility="Collapsed">
                                    <TextBlock x:Name="TextBlock_TTS_OpenAI_Config"
                                            Text="OpenAI TTS 配置"
                                            Style="{StaticResource SectionHeader}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_TTS_OpenAI_BaseUrl"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_OpenAI_BaseUrl"
                                            Text="https://api.fish.audio/v1/tts"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="请输入完整的TTS API地址，包含完整路径（如：https://api.fish.audio/v1/tts）"
                                            x:Name="TextBlock_TTS_OpenAI_BaseUrl_Tip"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_TTS_OpenAI_ApiKey"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_OpenAI_ApiKey"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label x:Name="Label_TTS_OpenAI_Model"
                                            Style="{StaticResource SettingLabel}"/>
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <ComboBox x:Name="ComboBox_TTS_OpenAI_Model"
                                                Grid.Column="0"
                                                IsEditable="True"
                                                Text="tts-1"
                                                Margin="0,0,8,0"
                                                Style="{StaticResource ModernComboBox}"/>
                                        <Button x:Name="Button_TTS_OpenAI_RefreshModels"
                                                Grid.Column="1"
                                                Content="刷新"
                                                Click="Button_TTS_OpenAI_RefreshModels_Click"
                                                Style="{StaticResource SecondaryButton}"
                                                Padding="8,4"
                                                FontSize="12"/>
                                    </Grid>

                                    <Label x:Name="Label_TTS_OpenAI_Voice"
                                            Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_OpenAI_Voice"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="alloy" Tag="alloy" IsSelected="True"/>
                                        <ComboBoxItem Content="echo" Tag="echo"/>
                                        <ComboBoxItem Content="fable" Tag="fable"/>
                                        <ComboBoxItem Content="onyx" Tag="onyx"/>
                                        <ComboBoxItem Content="nova" Tag="nova"/>
                                        <ComboBoxItem Content="shimmer" Tag="shimmer"/>
                                    </ComboBox>

                                    <Label x:Name="Label_TTS_OpenAI_Format"
                                            Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_OpenAI_Format"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="mp3" Tag="mp3" IsSelected="True"/>
                                        <ComboBoxItem Content="opus" Tag="opus"/>
                                        <ComboBoxItem Content="aac" Tag="aac"/>
                                        <ComboBoxItem Content="flac" Tag="flac"/>
                                    </ComboBox>

                                    <TextBlock Text="支持OpenAI TTS API格式的服务，如fish.audio等。需要提供有效的API Key。"
                                            x:Name="TextBlock_TTS_OpenAI_Description"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>
                                </StackPanel>
                                <!-- DIY TTS 配置 -->
                                <StackPanel x:Name="Panel_TTS_DIY"
                                        Visibility="Collapsed">
                                    <TextBlock x:Name="TextBlock_TTS_DIY_Config"
                                            Text="DIY TTS 配置"
                                            Style="{StaticResource SectionHeader}"
                                            Margin="0,0,0,16"/>

                                    <TextBlock x:Name="TextBlock_TTS_DIY_Description"
                                            Text="DIY TTS 使用 JSON 配置文件进行配置，支持强大的自定义功能。"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Button x:Name="Button_TTS_DIY_OpenConfig"
                                            Content="打开配置文件夹"
                                            Click="Button_TTS_DIY_OpenConfig_Click"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernButton}"/>

                                    <TextBlock x:Name="TextBlock_TTS_DIY_ConfigLocation"
                                            Text="配置文件位置: 文档\VPetLLM\DiyTTS\Config.json"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,8"/>

                                    <TextBlock x:Name="TextBlock_TTS_DIY_Features"
                                            Text="支持自定义请求头、请求体、请求方法等参数。User-Agent 将自动限制为 VPetLLM。"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>
                                </StackPanel>

                                <!-- GPT-SoVITS TTS 配置 -->
                                <StackPanel x:Name="Panel_TTS_GPTSoVITS"
                                        Visibility="Collapsed">
                                    <TextBlock Text="GPT-SoVITS TTS 配置"
                                            Style="{StaticResource SectionHeader}"
                                            Margin="0,0,0,8"/>
                                    
                                    <TextBlock Text="支持 GPT-SoVITS v2-v4 版本接口。系统会自动检测服务器支持的版本和可用模型。"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label Content="API 地址"
                                          Style="{StaticResource SettingLabel}"/>
                                    <Grid Margin="0,0,0,16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="TextBox_TTS_GPTSoVITS_BaseUrl"
                                                Grid.Column="0"
                                                Margin="0,0,8,0"
                                                Style="{StaticResource ModernTextBox}"/>
                                        <Button x:Name="Button_TTS_GPTSoVITS_DetectVersion"
                                                Grid.Column="1"
                                                Content="检测版本"
                                                Click="Button_TTS_GPTSoVITS_DetectVersion_Click"
                                                Padding="12,6"
                                                Style="{StaticResource ModernButton}"/>
                                    </Grid>

                                    <Label Content="API 版本"
                                          Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_GPTSoVITS_Version"
                                            Margin="0,0,0,8"
                                            SelectionChanged="ComboBox_TTS_GPTSoVITS_Version_SelectionChanged"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="v2" Tag="v2"/>
                                        <ComboBoxItem Content="v2Pro" Tag="v2Pro"/>
                                        <ComboBoxItem Content="v2ProPlus" Tag="v2ProPlus"/>
                                        <ComboBoxItem Content="v3" Tag="v3"/>
                                        <ComboBoxItem Content="v4" Tag="v4" IsSelected="True"/>
                                    </ComboBox>
                                    <TextBlock Text="选择版本后将自动加载该版本支持的模型列表"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label Content="模型"
                                          Style="{StaticResource SettingLabel}"/>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <ComboBox x:Name="ComboBox_TTS_GPTSoVITS_Model"
                                                Grid.Column="0"
                                                IsEditable="True"
                                                Margin="0,0,8,0"
                                                SelectionChanged="ComboBox_TTS_GPTSoVITS_Model_SelectionChanged"
                                                Style="{StaticResource ModernComboBox}"/>
                                        <Button x:Name="Button_TTS_GPTSoVITS_RefreshModels"
                                                Grid.Column="1"
                                                Content="刷新模型"
                                                Click="Button_TTS_GPTSoVITS_RefreshModels_Click"
                                                Padding="12,6"
                                                Style="{StaticResource SecondaryButton}"/>
                                    </Grid>
                                    <TextBlock Text="从服务器加载可用的模型列表"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label Content="语言"
                                          Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_GPTSoVITS_Language"
                                            Margin="0,0,0,8"
                                            SelectionChanged="ComboBox_TTS_GPTSoVITS_Language_SelectionChanged"
                                            Style="{StaticResource ModernComboBox}"/>
                                    <TextBlock Text="根据所选模型自动显示支持的语言，该语言将作为 prompt_text_lang"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label Content="情感"
                                          Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_GPTSoVITS_Emotion"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernComboBox}"/>

                                    <Label Content="目标文本语言"
                                          Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_GPTSoVITS_TextLanguage"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="中文" Tag="中文" IsSelected="True"/>
                                        <ComboBoxItem Content="粤语" Tag="粤语"/>
                                        <ComboBoxItem Content="英文" Tag="英文"/>
                                        <ComboBoxItem Content="日文" Tag="日文"/>
                                        <ComboBoxItem Content="韩文" Tag="韩文"/>
                                        <ComboBoxItem Content="中英混合" Tag="中英混合"/>
                                        <ComboBoxItem Content="粤英混合" Tag="粤英混合"/>
                                        <ComboBoxItem Content="日英混合" Tag="日英混合"/>
                                        <ComboBoxItem Content="韩英混合" Tag="韩英混合"/>
                                        <ComboBoxItem Content="多语种混合" Tag="多语种混合"/>
                                        <ComboBoxItem Content="多语种混合(粤语)" Tag="多语种混合(粤语)"/>
                                    </ComboBox>

                                    <TextBlock Text="可选配置（如已在服务端配置好模型，以下可留空）"
                                            Style="{StaticResource SectionHeader}"
                                            FontSize="14"
                                            Margin="0,8,0,8"/>

                                    <Label Content="参考音频路径（可选）"
                                          Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_GPTSoVITS_ReferWavPath"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label Content="参考文本（可选）"
                                          Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_GPTSoVITS_PromptText"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="参考文本语言固定为中文"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <TextBlock Text="高级设置"
                                            Style="{StaticResource SectionHeader}"
                                            FontSize="14"
                                            Margin="0,8,0,8"/>

                                    <Label Content="文本切分方法"
                                          Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_TTS_GPTSoVITS_SplitMethod"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="不切" Tag="不切"/>
                                        <ComboBoxItem Content="凑四句一切" Tag="凑四句一切"/>
                                        <ComboBoxItem Content="凑50字一切" Tag="凑50字一切"/>
                                        <ComboBoxItem Content="按中文句号。切" Tag="按中文句号。切"/>
                                        <ComboBoxItem Content="按英文句号.切" Tag="按英文句号.切"/>
                                        <ComboBoxItem Content="按标点符号切" Tag="按标点符号切" IsSelected="True"/>
                                    </ComboBox>
                                    <TextBlock Text="选择文本切分方式，影响语音合成的流畅度"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label Content="切分符号（可选，如：,.;?!）"
                                          Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_GPTSoVITS_CutPunc"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label Content="Top K（默认：15）"
                                          Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_GPTSoVITS_TopK"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label Content="Top P（默认：1.0）"
                                          Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_GPTSoVITS_TopP"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label Content="Temperature（默认：1.0）"
                                          Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_GPTSoVITS_Temperature"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label Content="Speed（默认：1.0）"
                                          Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_TTS_GPTSoVITS_Speed"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <!-- ASR 子标签页 -->
            <TabItem Header="{utils:Localize KeyPath=ASR.Tab, Default=语音输入}"
                    x:Name="Tab_ASR"
                    Style="{StaticResource ModernTabItem}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <ScrollViewer Grid.Column="0"
                            VerticalScrollBarVisibility="Auto">
                        <Border Style="{StaticResource CardContainer}" Margin="0,0,10,0">
                            <StackPanel Style="{StaticResource SettingGroup}">
                                <CheckBox x:Name="CheckBox_ASR_IsEnabled"
                                        Content="{utils:Localize KeyPath=ASR.Enable, Default=启用语音输入}"
                                        Margin="0,0,0,16"
                                        Style="{StaticResource ModernCheckBox}">
                                    <CheckBox.ToolTip>
                                        <ToolTip>
                                            <TextBlock Text="{utils:Localize KeyPath=ASR.EnableTooltip, Default=启用后可以使用快捷键进行语音输入}"/>
                                        </ToolTip>
                                    </CheckBox.ToolTip>
                                </CheckBox>

                                <StackPanel IsEnabled="{Binding ElementName=CheckBox_ASR_IsEnabled, Path=IsChecked}">
                                    <Label Content="{utils:Localize KeyPath=ASR.Provider, Default=识别提供商}"
                                            x:Name="Label_ASR_Provider"
                                            Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_ASR_Provider"
                                            Margin="0,0,0,16"
                                            SelectionChanged="ComboBox_ASR_Provider_SelectionChanged"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="OpenAI Whisper" Tag="OpenAI" IsSelected="True"/>
                                        <ComboBoxItem Content="Soniox" Tag="Soniox"/>
                                    </ComboBox>

                                    <Label Content="{utils:Localize KeyPath=ASR.RecordingDevice, Default=输入设备}"
                                            x:Name="Label_ASR_RecordingDevice"
                                            Style="{StaticResource SettingLabel}"/>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <ComboBox x:Name="ComboBox_ASR_RecordingDevice"
                                                Grid.Column="0"
                                                Margin="0,0,8,0"
                                                Style="{StaticResource ModernComboBox}">
                                            <ComboBoxItem Content="设备 #0 (默认)" Tag="0" IsSelected="True"/>
                                        </ComboBox>
                                        <Button x:Name="Button_ASR_RefreshDevices"
                                                Grid.Column="1"
                                                Content="{utils:Localize KeyPath=ASR.RefreshDevices, Default=刷新设备}"
                                                Click="Button_ASR_RefreshDevices_Click"
                                                Padding="12,6"
                                                Style="{StaticResource ModernButton}"/>
                                    </Grid>
                                    <TextBlock Text="{utils:Localize KeyPath=ASR.RecordingDeviceTip, Default=选择用于语音输入的麦克风设备}"
                                            x:Name="TextBlock_ASR_RecordingDevice_Tip"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <CheckBox x:Name="CheckBox_ASR_AutoSend"
                                            Content="{utils:Localize KeyPath=ASR.AutoSend, Default=识别完成后自动发送}"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernCheckBox}"/>

                                    <CheckBox x:Name="CheckBox_ASR_ShowTranscriptionWindow"
                                            Content="{utils:Localize KeyPath=ASR.ShowTranscriptionWindow, Default=显示识别结果窗口}"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernCheckBox}"/>

                                    <Label Content="{utils:Localize KeyPath=ASR.Hotkey, Default=快捷键}"
                                            x:Name="Label_ASR_Hotkey"
                                            Style="{StaticResource SettingLabel}"/>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Grid.Column="0"
                                                x:Name="TextBox_ASR_HotkeyDisplay"
                                                IsReadOnly="True"
                                                Style="{StaticResource ModernTextBox}"
                                                ToolTip="当前快捷键"/>
                                        <Button Grid.Column="1"
                                                x:Name="Button_ASR_CaptureHotkey"
                                                Content="{utils:Localize KeyPath=ASR.CaptureHotkey, Default=捕获快捷键}"
                                                Click="Button_ASR_CaptureHotkey_Click"
                                                Margin="8,0,0,0"
                                                Padding="12,6"
                                                Style="{StaticResource ModernButton}"/>
                                        <Button Grid.Column="2"
                                                x:Name="Button_ASR_ResetHotkey"
                                                Content="{utils:Localize KeyPath=ASR.ResetHotkey, Default=还原默认}"
                                                Click="Button_ASR_ResetHotkey_Click"
                                                Margin="8,0,0,0"
                                                Padding="12,6"
                                                Style="{StaticResource ModernButton}"/>
                                    </Grid>
                                    <TextBlock Text="{utils:Localize KeyPath=ASR.HotkeyDescription, Default=点击捕获按钮后，按下您想要的快捷键组合}"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,8"/>
                                    <TextBlock Text="{utils:Localize KeyPath=ASR.DefaultHotkey, Default=默认快捷键: Win + Alt + V}"
                                            Style="{StaticResource DescriptionText}"
                                            Foreground="#666666"
                                            FontSize="11"
                                            Margin="0,0,0,16"/>

                                    <WrapPanel HorizontalAlignment="Right" Margin="0,0,0,0">
                                        <Button x:Name="Button_ASR_Test"
                                                Content="{utils:Localize KeyPath=ASR.TestButton, Default=测试语音输入}"
                                                Click="Button_ASR_Test_Click"
                                                Style="{StaticResource ModernButton}"/>
                                    </WrapPanel>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>

                    <ScrollViewer Grid.Column="1"
                            VerticalScrollBarVisibility="Auto">
                        <Border Style="{StaticResource CardContainer}">
                            <StackPanel Style="{StaticResource SettingGroup}"

                                IsEnabled="{Binding ElementName=CheckBox_ASR_IsEnabled, Path=IsChecked}">
                                <!-- OpenAI Whisper 配置 -->
                                <StackPanel x:Name="Panel_ASR_OpenAI"
                                        Visibility="Visible">
                                    <TextBlock x:Name="TextBlock_ASR_OpenAI_Config"
                                            Text="{utils:Localize KeyPath=ASR.OpenAISettings, Default=OpenAI Whisper 配置}"
                                            Style="{StaticResource SectionHeader}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_ASR_OpenAI_BaseUrl"
                                            Content="{utils:Localize KeyPath=ASR.OpenAI.BaseUrl, Default=API 地址}"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_ASR_OpenAI_BaseUrl"
                                            Text="https://api.openai.com/v1"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="{utils:Localize KeyPath=ASR.OpenAI.BaseUrlTip, Default=请输入 API 基础地址（不含 /audio/transcriptions）}"
                                            x:Name="TextBlock_ASR_OpenAI_BaseUrl_Tip"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_ASR_OpenAI_ApiKey"
                                            Content="{utils:Localize KeyPath=ASR.OpenAI.ApiKey, Default=API Key}"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_ASR_OpenAI_ApiKey"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label x:Name="Label_ASR_OpenAI_Model"
                                            Content="{utils:Localize KeyPath=ASR.OpenAI.Model, Default=模型}"
                                            Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_ASR_OpenAI_Model"
                                            IsEditable="True"
                                            Text="whisper-1"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="whisper-1" Tag="whisper-1"/>
                                        <ComboBoxItem Content="FunAudioLLM/SenseVoiceSmall" Tag="FunAudioLLM/SenseVoiceSmall"/>
                                    </ComboBox>

                                    <TextBlock Text="{utils:Localize KeyPath=ASR.OpenAI.Description, Default=支持 OpenAI Whisper API 格式的语音识别服务}"
                                            x:Name="TextBlock_ASR_OpenAI_Description"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,8"/>

                                    <!-- 服务示例 -->
                                    <TextBlock Style="{StaticResource SectionHeader}"
                                            Margin="0,16,0,8">
                                        <Run Text="{utils:Localize KeyPath=ASR.Examples, Default=服务示例}" FontSize="14"/>
                                    </TextBlock>
                                    <TextBlock Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,4">
                                        <Run Text="• OpenAI: " FontWeight="SemiBold"/>
                                        <Run Text="https://api.openai.com/v1" Foreground="#2196F3"/>
                                        <Run Text=" | whisper-1"/>
                                    </TextBlock>
                                    <TextBlock Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,4">
                                        <Run Text="• SiliconFlow: " FontWeight="SemiBold"/>
                                        <Run Text="https://api.siliconflow.cn/v1" Foreground="#2196F3"/>
                                        <Run Text=" | FunAudioLLM/SenseVoiceSmall"/>
                                    </TextBlock>
                                    <TextBlock Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16">
                                        <Run Text="• 自定义: 任何兼容 OpenAI Whisper API 格式的服务"/>
                                    </TextBlock>
                                </StackPanel>

                                <!-- Soniox 配置 -->
                                <StackPanel x:Name="Panel_ASR_Soniox"
                                        Visibility="Collapsed">
                                    <TextBlock x:Name="TextBlock_ASR_Soniox_Config"
                                            Text="{utils:Localize KeyPath=ASR.SonioxSettings, Default=Soniox 配置}"
                                            Style="{StaticResource SectionHeader}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_ASR_Soniox_BaseUrl"
                                            Content="{utils:Localize KeyPath=ASR.Soniox.BaseUrl, Default=API 地址}"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_ASR_Soniox_BaseUrl"
                                            Text="https://api.soniox.com"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="{utils:Localize KeyPath=ASR.Soniox.BaseUrlTip, Default=请输入 Soniox API 基础地址（不含 /v1）}"
                                            x:Name="TextBlock_ASR_Soniox_BaseUrl_Tip"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_ASR_Soniox_ApiKey"
                                            Content="{utils:Localize KeyPath=ASR.Soniox.ApiKey, Default=API Key}"
                                            Style="{StaticResource SettingLabel}"/>
                                    <TextBox x:Name="TextBox_ASR_Soniox_ApiKey"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernTextBox}"/>

                                    <Label x:Name="Label_ASR_Soniox_Model"
                                            Content="{utils:Localize KeyPath=ASR.Soniox.Model, Default=模型}"
                                            Style="{StaticResource SettingLabel}"/>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <ComboBox x:Name="ComboBox_ASR_Soniox_Model"
                                                Grid.Column="0"
                                                IsEditable="True"
                                                Text="stt-rt-v3"
                                                Margin="0,0,8,0"
                                                Style="{StaticResource ModernComboBox}">
                                            <ComboBoxItem Content="stt-rt-v3 (Speech-to-Text Real-time v3)" Tag="stt-rt-v3"/>
                                            <ComboBoxItem Content="stt-async-v3 (Speech-to-Text Async v3)" Tag="stt-async-v3"/>
                                        </ComboBox>
                                        <Button x:Name="Button_ASR_Soniox_RefreshModels"
                                                Grid.Column="1"
                                                Content="{utils:Localize KeyPath=ASR.Soniox.RefreshModels, Default=刷新模型列表}"
                                                Click="Button_ASR_Soniox_RefreshModels_Click"
                                                Padding="12,6"
                                                Style="{StaticResource ModernButton}"/>
                                    </Grid>
                                    <TextBlock Text="{utils:Localize KeyPath=ASR.Soniox.ModelTip, Default=选择 Soniox 语音识别模型，点击刷新按钮获取最新模型列表}"
                                            x:Name="TextBlock_ASR_Soniox_Model_Tip"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <Label x:Name="Label_ASR_Soniox_Language"
                                            Content="{utils:Localize KeyPath=ASR.Soniox.Language, Default=语言}"
                                            Style="{StaticResource SettingLabel}"/>
                                    <ComboBox x:Name="ComboBox_ASR_Soniox_Language"
                                            IsEditable="False"
                                            Margin="0,0,0,8"
                                            Style="{StaticResource ModernComboBox}">
                                        <!-- 语言列表将根据选择的模型动态填充 -->
                                    </ComboBox>
                                    <TextBlock Text="{utils:Localize KeyPath=ASR.Soniox.LanguageTip, Default=选择语音识别语言，语言列表根据所选模型动态更新}"
                                            x:Name="TextBlock_ASR_Soniox_Language_Tip"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>

                                    <CheckBox x:Name="CheckBox_ASR_Soniox_EnablePunctuation"
                                            Content="{utils:Localize KeyPath=ASR.Soniox.EnablePunctuation, Default=启用标点符号}"
                                            Margin="0,0,0,8"
                                            IsChecked="True"
                                            Style="{StaticResource ModernCheckBox}"/>

                                    <CheckBox x:Name="CheckBox_ASR_Soniox_EnableProfanityFilter"
                                            Content="{utils:Localize KeyPath=ASR.Soniox.EnableProfanityFilter, Default=启用脏话过滤}"
                                            Margin="0,0,0,16"
                                            Style="{StaticResource ModernCheckBox}"/>

                                    <TextBlock Text="{utils:Localize KeyPath=ASR.Soniox.Description, Default=Soniox 提供高精度的语音识别服务，支持多种语言}"
                                            x:Name="TextBlock_ASR_Soniox_Description"
                                            Style="{StaticResource DescriptionText}"
                                            Margin="0,0,0,16"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </TabControl>
            </TabItem>
            
            <TabItem Header="{utils:Localize KeyPath=Language.Tab}"
                    x:Name="Tab_Language"
                    Style="{StaticResource ModernTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Border Style="{StaticResource CardContainer}">
                        <StackPanel Style="{StaticResource SettingGroup}">
                            <Label Content="{utils:Localize KeyPath=Language.Tab}"
                                    x:Name="Label_Language"
                                    Style="{StaticResource SettingLabel}"/>
                            <ComboBox x:Name="ComboBox_Language"
                                    Margin="0,0,0,16"
                                    Style="{StaticResource LanguageComboBox}"/>
                            <Label Content="{utils:Localize KeyPath=Language.PromptLanguage}"
                                    x:Name="Label_PromptLanguage"
                                    Style="{StaticResource SettingLabel}"/>
                            <ComboBox x:Name="ComboBox_PromptLanguage"
                                    Margin="0,0,0,8"
                                    Style="{StaticResource LanguageComboBox}"/>
                            <TextBlock x:Name="TextBlock_PromptLanguageTooltip"
                                    TextWrapping="Wrap"
                                    Foreground="{StaticResource SecondaryTextBrush}"
                                    FontSize="12"
                                    Margin="0,0,0,0"/>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="{utils:Localize KeyPath=Advanced_Options.Tab}"
                    x:Name="Tab_Advanced"
                    Style="{StaticResource ModernTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Border Style="{StaticResource CardContainer}">
                        <StackPanel Style="{StaticResource SettingGroup}">
                            <CheckBox x:Name="CheckBox_EnableAction"
                                    Content="{utils:Localize KeyPath=Advanced_Options.EnableAction}"
                                    Margin="0,0,0,16"
                                    IsChecked="True"
                                    Style="{StaticResource ModernCheckBox}">
                                <CheckBox.ToolTip>
                                    <ToolTip>
                                        <TextBlock Text="{utils:Localize KeyPath=Advanced_Options.EnableActionToolTip}"/>
                                    </ToolTip>
                                </CheckBox.ToolTip>
                            </CheckBox>
                            <StackPanel Margin="20,0,0,0">
                                <CheckBox x:Name="CheckBox_EnableBuy"
                                        Content="{utils:Localize KeyPath=Advanced_Options.EnableBuy}"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckBox_EnableAction}"
                                        IsChecked="True"
                                        Margin="0,0,0,8"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_EnableState"
                                        Content="{utils:Localize KeyPath=Advanced_Options.EnableState}"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckBox_EnableAction}"
                                        IsChecked="True"
                                        Margin="0,0,0,8"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_EnableActionExecution"
                                        Content="{utils:Localize KeyPath=Advanced_Options.EnableActionExecution}"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckBox_EnableAction}"
                                        IsChecked="True"
                                        Margin="0,0,0,8"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_EnableMove"
                                        Content="{utils:Localize KeyPath=Advanced_Options.EnableMove}"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckBox_EnableAction}"
                                        IsChecked="True"
                                        Margin="0,0,0,8"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_EnableTime"
                                        Content="{utils:Localize KeyPath=Advanced_Options.EnableTime}"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckBox_EnableAction}"
                                        IsChecked="True"
                                        Margin="0,0,0,8"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <CheckBox x:Name="CheckBox_EnableBuyFeedback"
                                        IsEnabled="{Binding IsChecked, ElementName=CheckBox_EnableAction}"
                                        IsChecked="True"
                                        Margin="0,0,0,16"
                                        Style="{StaticResource ModernCheckBox}">
                                    <CheckBox.ToolTip>
                                        <ToolTip>
                                            <TextBlock x:Name="ToolTip_EnableBuyFeedback" Text="{utils:Localize KeyPath=BuyInteraction.EnableTooltip}"/>
                                        </ToolTip>
                                    </CheckBox.ToolTip>
                                </CheckBox>
                                <CheckBox x:Name="CheckBox_EnableLiveMode"
                                        Content="{utils:Localize KeyPath=Advanced_Options.EnableLiveMode}"
                                        IsChecked="False"
                                        Margin="0,0,0,16"
                                        Style="{StaticResource ModernCheckBox}">
                                    <CheckBox.ToolTip>
                                        <ToolTip>
                                            <TextBlock Text="{utils:Localize KeyPath=Advanced_Options.EnableLiveModeToolTip}"/>
                                        </ToolTip>
                                    </CheckBox.ToolTip>
                                </CheckBox>
                                <CheckBox x:Name="CheckBox_EnableHistoryCompression"
                                        Content="{utils:Localize KeyPath=Advanced_Options.EnableHistoryCompression}"
                                        Margin="0,0,0,12"
                                        Style="{StaticResource ModernCheckBox}"/>
                                <!-- 压缩触发模式 -->
                                <StackPanel Orientation="Horizontal"
                                        Margin="20,0,0,12">
                                    <TextBlock Text="{utils:Localize KeyPath=Advanced_Options.CompressionMode}"
                                            VerticalAlignment="Center"
                                            x:Name="TextBlock_CompressionMode"
                                            Foreground="{StaticResource PrimaryTextBrush}"
                                            FontSize="14"
                                            Width="80"/>
                                    <ComboBox x:Name="ComboBox_CompressionMode"
                                            Width="150"
                                            Margin="10,0"
                                            Style="{StaticResource ModernComboBox}">
                                        <ComboBoxItem Content="{utils:Localize KeyPath=Advanced_Options.CompressionMode_MessageCount}" Tag="MessageCount"/>
                                        <ComboBoxItem Content="{utils:Localize KeyPath=Advanced_Options.CompressionMode_TokenCount}" Tag="TokenCount"/>
                                        <ComboBoxItem Content="{utils:Localize KeyPath=Advanced_Options.CompressionMode_Both}" Tag="Both"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <!-- 消息数量阈值 -->
                                <StackPanel Orientation="Horizontal"
                                        Margin="20,0,0,12">
                                    <TextBlock Text="{utils:Localize KeyPath=Advanced_Options.HistoryCompressionThreshold}"
                                            VerticalAlignment="Center"
                                            x:Name="TextBlock_HistoryCompressionThreshold"
                                            Foreground="{StaticResource PrimaryTextBrush}"
                                            FontSize="14"
                                            Width="80"/>
                                    <TextBox x:Name="TextBox_HistoryCompressionThreshold"
                                            Width="110"
                                            Margin="10,0"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="{utils:Localize KeyPath=Advanced_Options.CurrentContextLength}"
                                            VerticalAlignment="Center"
                                            Margin="20,0,5,0"
                                            x:Name="TextBlock_CurrentContextLengthLabel"
                                            Foreground="{StaticResource PrimaryTextBrush}"
                                            FontSize="14"/>
                                    <TextBlock x:Name="TextBlock_CurrentContextLength"
                                            VerticalAlignment="Center"
                                            Foreground="{StaticResource SecondaryTextBrush}"
                                            FontSize="14"/>
                                </StackPanel>
                                
                                <!-- Token数量阈值 -->
                                <StackPanel Orientation="Horizontal"
                                        Margin="20,0,0,0">
                                    <TextBlock Text="{utils:Localize KeyPath=Advanced_Options.HistoryCompressionTokenThreshold}"
                                            VerticalAlignment="Center"
                                            x:Name="TextBlock_HistoryCompressionTokenThreshold"
                                            Foreground="{StaticResource PrimaryTextBrush}"
                                            FontSize="14"
                                            Width="80"/>
                                    <TextBox x:Name="TextBox_HistoryCompressionTokenThreshold"
                                            Width="110"
                                            Margin="10,0"
                                            Style="{StaticResource ModernTextBox}"/>
                                    <TextBlock Text="{utils:Localize KeyPath=Advanced_Options.CurrentTokenCount}"
                                            VerticalAlignment="Center"
                                            Margin="20,0,5,0"
                                            x:Name="TextBlock_CurrentTokenCountLabel"
                                            Foreground="{StaticResource PrimaryTextBrush}"
                                            FontSize="14"/>
                                    <TextBlock x:Name="TextBlock_CurrentTokenCount"
                                            VerticalAlignment="Center"
                                            Foreground="{StaticResource SecondaryTextBrush}"
                                            FontSize="14"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- 身体交互设置 -->
                            <Separator Margin="0,20,0,20"
                                     Background="{StaticResource BorderBrush}"
                                     Height="1"/>
                            <TextBlock Name="TextBlock_TouchFeedbackTitle"
                                     Text="{utils:Localize KeyPath=TouchFeedback.Title}"
                                     FontSize="16"
                                     FontWeight="SemiBold"
                                     Margin="0,0,0,16"
                                     Foreground="{StaticResource PrimaryTextBrush}"/>
                            <ContentPresenter x:Name="TouchFeedbackSettingsContainer"/>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="{utils:Localize KeyPath=Tools.Tab}"
                    x:Name="Tab_Tools"
                    Style="{StaticResource ModernTabItem}">
                <Border Style="{StaticResource CardContainer}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- 简化的工具管理头部 -->
                        <Border Background="{StaticResource ControlBackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="16,12"
                                Margin="0,0,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 标题区域 -->
                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock x:Name="TextBlock_ToolsManagement"
                                            Text="{utils:Localize KeyPath=Tools.Management}"
                                            FontSize="16"
                                            FontWeight="SemiBold"
                                            Foreground="{StaticResource PrimaryTextBrush}"
                                            Margin="0,0,0,2"/>
                                    <TextBlock x:Name="TextBlock_ToolsManagementDescription"
                                            Text="{utils:Localize KeyPath=Tools.ManagementDescription}"
                                            Foreground="{StaticResource SecondaryTextBrush}"
                                            FontSize="12"/>
                                </StackPanel>

                                <!-- 操作按钮 -->
                                <StackPanel Grid.Column="1" 
                                           Orientation="Horizontal" 
                                           VerticalAlignment="Center">
                                    <Button x:Name="Button_AddTool"
                                            Content="{utils:Localize KeyPath=Tools.Add}"
                                            Margin="0,0,8,0"
                                            Padding="12,6"
                                            Click="Button_AddTool_Click"
                                            Style="{StaticResource PrimaryButton}"/>
                                    <Button x:Name="Button_DeleteTool"
                                            Content="{utils:Localize KeyPath=Tools.Delete}"
                                            Padding="12,6"
                                            Click="Button_DeleteTool_Click"
                                            Style="{StaticResource SecondaryButton}"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- 简化的工具列表容器 -->
                        <Border Background="{StaticResource ControlBackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="6"
                                Grid.Row="1">
                            <DataGrid x:Name="DataGrid_Tools"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    RowHeight="60"
                                    GridLinesVisibility="Horizontal"
                                    HeadersVisibility="Column"
                                    AlternatingRowBackground="{StaticResource SecondaryBrush}"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Style="{StaticResource ModernDataGrid}"
                                    ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeader}"
                                    HorizontalGridLinesBrush="{StaticResource BorderBrush}"
                                    SelectionMode="Single"
                                    SelectionUnit="FullRow">
                                <DataGrid.Columns>
                                    <!-- 简化的启用状态列 -->
                                    <DataGridTemplateColumn Header="{utils:Localize KeyPath=Tools.Enabled}" Width="60">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsEnabled, UpdateSourceTrigger=PropertyChanged}"
                                                         HorizontalAlignment="Center"
                                                         VerticalAlignment="Center"
                                                         Style="{StaticResource ModernCheckBox}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ModernDataGridColumnHeader}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTemplateColumn.HeaderStyle>
                                    </DataGridTemplateColumn>

                                    <!-- 工具名称列 -->
                                    <DataGridTextColumn Header="{utils:Localize KeyPath=Tools.Name}"
                                    Binding="{Binding Name}"
                                    Width="150"
                                    MinWidth="120">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,6"/>
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                                <Setter Property="ToolTip" Value="{Binding Name}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>

                                    <!-- URL 列 -->
                                    <DataGridTextColumn Header="{utils:Localize KeyPath=Tools.URL}"
                                    Binding="{Binding Url}"
                                    Width="200"
                                    MinWidth="150">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,6"/>
                                                <Setter Property="Foreground" Value="{StaticResource AccentBrush}"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                                <Setter Property="ToolTip" Value="{Binding Url}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>

                                    <!-- 工具描述列 -->
                                    <DataGridTextColumn Header="{utils:Localize KeyPath=Tools.Description}"
                                    Binding="{Binding Description}"
                                    Width="*"
                                    MinWidth="200">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,6"/>
                                                <Setter Property="TextWrapping" Value="Wrap"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
                                                <Setter Property="LineHeight" Value="18"/>
                                                <Setter Property="MaxHeight" Value="44"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>

                                    <!-- ApiKey 列 -->
                                    <DataGridTextColumn Header="{utils:Localize KeyPath=Tools.ApiKey}"
                                    Binding="{Binding ApiKey}"
                                    Width="150"
                                    MinWidth="120">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,6"/>
                                                <Setter Property="Foreground" Value="{StaticResource SecondaryTextBrush}"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="FontFamily" Value="Consolas"/>
                                                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                                <Setter Property="ToolTip" Value="{Binding ApiKey}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>
                    </Grid>
                </Border>
            </TabItem>
            <TabItem Header="{utils:Localize KeyPath=Log.Tab}"
                    x:Name="Tab_Log"
                    Style="{StaticResource ModernTabItem}">
                <Border Style="{StaticResource CardContainer}">
                    <DockPanel>
                        <StackPanel DockPanel.Dock="Top"
                                Orientation="Horizontal"
                                HorizontalAlignment="Left"
                                Margin="0,0,0,16">
                            <CheckBox x:Name="CheckBox_LogAutoScroll"
                                    Content="{utils:Localize KeyPath=Log.AutoScroll}"
                                    Margin="0,0,20,0"
                                    Style="{StaticResource ModernCheckBox}"/>
                            <TextBlock Text="{utils:Localize KeyPath=Log.MaxLogCount}"
                                    VerticalAlignment="Center"
                                    Margin="0,0,8,0"
                                    x:Name="TextBlock_MaxLogCount"
                                    Foreground="{StaticResource PrimaryTextBrush}"
                                    FontSize="14"/>
                            <TextBox x:Name="TextBox_MaxLogCount"
                                    Width="185"
                                    VerticalAlignment="Center"
                                    Style="{StaticResource ModernTextBox}"/>
                        </StackPanel>
                        <StackPanel DockPanel.Dock="Bottom"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                Margin="0,16,0,0">
                            <Button x:Name="Button_CopyLog"
                                    Content="{utils:Localize KeyPath=Log.Copy}"
                                    Click="Button_CopyLog_Click"
                                    Margin="0,0,8,0"
                                    Style="{StaticResource SecondaryButton}"/>
                            <Button x:Name="Button_ClearLog"
                                    Content="{utils:Localize KeyPath=Log.Clear}"
                                    Click="Button_ClearLog_Click"
                                    Style="{StaticResource SecondaryButton}"/>
                        </StackPanel>
                        <ListBox x:Name="LogBox"
                                MinHeight="200"
                                Background="{StaticResource BackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1"
                                ScrollViewer.CanContentScroll="False"
                                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                    </DockPanel>
                </Border>
            </TabItem>
            <TabItem Header="{utils:Localize KeyPath=Plugin.Tab}"
                    x:Name="Tab_Plugin"
                    Style="{StaticResource ModernTabItem}">
                <Border Style="{StaticResource CardContainer}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- 简化的插件管理头部 -->
                        <Border Background="{StaticResource ControlBackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="16,12"
                                Margin="0,0,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 标题区域 -->
                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock x:Name="TextBlock_PluginManagementCenter"
                                            Text="{utils:Localize KeyPath=Plugin.ManagementCenter}"
                                            FontSize="16"
                                            FontWeight="SemiBold"
                                            Foreground="{StaticResource PrimaryTextBrush}"
                                            Margin="0,0,0,2"/>
                                    <TextBlock x:Name="TextBlock_HowToUse"
                                            Foreground="{StaticResource SecondaryTextBrush}"
                                            FontSize="12"/>
                                </StackPanel>

                                <!-- 操作按钮 -->
                                <StackPanel Grid.Column="1" 
                                           Orientation="Horizontal" 
                                           VerticalAlignment="Center">
                                    <Button x:Name="Button_RefreshPlugins"
                                            Content="{utils:Localize KeyPath=Plugin.Refresh}"
                                            Margin="0,0,8,0"
                                            Padding="12,6"
                                            Click="Button_RefreshPlugins_Click"
                                            Style="{StaticResource SecondaryButton}"/>
                                    <Button x:Name="Button_ImportPlugin"
                                            Content="{utils:Localize KeyPath=Plugin.ImportPlugin}"
                                            Padding="12,6"
                                            Click="Button_ImportPlugin_Click"
                                            Style="{StaticResource PrimaryButton}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        <!-- 简化的插件列表容器 -->
                        <Border Background="{StaticResource ControlBackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="6"
                                Grid.Row="1">
                            <DataGrid x:Name="DataGrid_Plugins"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    SelectionChanged="DataGrid_Plugins_SelectionChanged"
                                    RowHeight="60"
                                    GridLinesVisibility="Horizontal"
                                    HeadersVisibility="Column"
                                    AlternatingRowBackground="{StaticResource SecondaryBrush}"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Style="{StaticResource ModernDataGrid}"
                                    ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeader}"
                                    HorizontalGridLinesBrush="{StaticResource BorderBrush}"
                                    SelectionMode="Single"
                                    SelectionUnit="FullRow">
                                <DataGrid.Columns>
                                    <!-- 简化的启用状态列 -->
                                    <DataGridTemplateColumn Header="{utils:Localize KeyPath=Plugin.Enabled}" Width="60">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsEnabled, UpdateSourceTrigger=PropertyChanged}"
                                                         IsEnabled="{Binding IsFailed, Converter={StaticResource BoolInverter}}"
                                                         Click="PluginEnabled_Click"
                                                         HorizontalAlignment="Center"
                                                         VerticalAlignment="Center"
                                                         Style="{StaticResource ModernCheckBox}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ModernDataGridColumnHeader}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTemplateColumn.HeaderStyle>
                                    </DataGridTemplateColumn>

                                    <!-- 优化的插件状态列 -->
                                    <DataGridTemplateColumn Header="{utils:Localize KeyPath=Plugin.Status}" Width="80">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" 
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center">
                                                    <!-- 状态指示器 -->
                                                    <Ellipse x:Name="StatusIndicator"
                                                            Width="8"
                                                            Height="8"
                                                            Fill="#38B2AC"
                                                            Margin="0,0,6,0"
                                                            VerticalAlignment="Center"/>

                                                    <!-- 状态文字 -->
                                                    <TextBlock x:Name="StatusTextDisplay"
                                                              Text="{Binding StatusText}"
                                                              FontSize="11"
                                                              Foreground="#38B2AC"
                                                              FontWeight="Medium"
                                                              VerticalAlignment="Center"/>
                                                </StackPanel>

                                                <DataTemplate.Triggers>
                                                    <!-- 错误状态 -->
                                                    <DataTrigger Binding="{Binding IsFailed}" Value="True">
                                                        <Setter TargetName="StatusIndicator" Property="Fill" Value="#E53E3E"/>
                                                        <Setter TargetName="StatusTextDisplay" Property="Foreground" Value="#E53E3E"/>
                                                    </DataTrigger>

                                                    <!-- 禁用状态 -->
                                                    <DataTrigger Binding="{Binding IsEnabled}" Value="False">
                                                        <Setter TargetName="StatusIndicator" Property="Fill" Value="#A0AEC0"/>
                                                        <Setter TargetName="StatusTextDisplay" Property="Foreground" Value="#A0AEC0"/>
                                                    </DataTrigger>

                                                    <!-- 待启动状态 -->
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding IsEnabled}" Value="True"/>
                                                            <Condition Binding="{Binding IsLoaded}" Value="False"/>
                                                        </MultiDataTrigger.Conditions>
                                                        <Setter TargetName="StatusIndicator" Property="Fill" Value="#F6AD55"/>
                                                        <Setter TargetName="StatusTextDisplay" Property="Foreground" Value="#F6AD55"/>
                                                    </MultiDataTrigger>

                                                    <!-- 正常运行状态 -->
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding IsEnabled}" Value="True"/>
                                                            <Condition Binding="{Binding IsFailed}" Value="False"/>
                                                        </MultiDataTrigger.Conditions>
                                                        <Setter TargetName="StatusIndicator" Property="Fill" Value="#38B2AC"/>
                                                        <Setter TargetName="StatusTextDisplay" Property="Foreground" Value="#38B2AC"/>
                                                    </MultiDataTrigger>

                                                    <!-- 未下载状态 (最后处理，确保优先级最高) -->
                                                    <DataTrigger Binding="{Binding IsLocal}" Value="False">
                                                        <Setter TargetName="StatusIndicator" Property="Fill" Value="#718096"/>
                                                        <Setter TargetName="StatusTextDisplay" Property="Foreground" Value="#718096"/>
                                                    </DataTrigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ModernDataGridColumnHeader}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTemplateColumn.HeaderStyle>
                                    </DataGridTemplateColumn>
                                    <!-- 简化的插件信息列 -->
                                    <DataGridTemplateColumn Header="{utils:Localize KeyPath=Plugin.Name}" Width="200" MinWidth="180">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="8,6" VerticalAlignment="Center">
                                                    <!-- 插件名称 -->
                                                    <TextBlock Text="{Binding Name}"
                                                              FontSize="14"
                                                              FontWeight="SemiBold"
                                                              Foreground="{StaticResource PrimaryTextBrush}"
                                                              TextTrimming="CharacterEllipsis"
                                                              ToolTip="{Binding Name}"
                                                              Margin="0,0,0,2"/>

                                                    <!-- 作者信息 -->
                                                    <TextBlock Text="{Binding Author}"
                                                              FontSize="12"
                                                              Foreground="{StaticResource SecondaryTextBrush}"
                                                              TextTrimming="CharacterEllipsis"
                                                              ToolTip="{Binding Author}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <!-- 插件描述列 -->
                                    <DataGridTemplateColumn Header="{utils:Localize KeyPath=Plugin.Description}" Width="*" MinWidth="250">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Description}"
                                                          Margin="8,6"
                                                          FontSize="12"
                                                          Foreground="{StaticResource PrimaryTextBrush}"
                                                          TextWrapping="Wrap"
                                                          TextTrimming="CharacterEllipsis"
                                                          VerticalAlignment="Center"
                                                          MaxHeight="44"
                                                          LineHeight="16"
                                                          ToolTip="{Binding Description}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <!-- 简化的操作列 -->
                                    <DataGridTemplateColumn Header="{utils:Localize KeyPath=Plugin.Action}" Width="160" MinWidth="140">
                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ModernDataGridColumnHeader}">
                                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTemplateColumn.HeaderStyle>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" 
                                                           Margin="8,6"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center">

                                                    <!-- 主要操作按钮 -->
                                                    <Button Click="Button_PluginAction_Click" 
                                                           Content="{Binding ActionText}"
                                                           Margin="0,0,4,0"
                                                           Padding="8,4"
                                                           FontSize="12">
                                                        <Button.Style>
                                                            <Style TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                <Style.Triggers>
                                                                    <MultiDataTrigger>
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding IsLocal}" Value="True"/>
                                                                            <Condition Binding="{Binding IsFailed}" Value="False"/>
                                                                            <Condition Binding="{Binding IsUpdatable}" Value="False"/>
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                                    </MultiDataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>

                                                    <!-- 设置按钮 -->
                                                    <Button Click="Button_PluginSetting_Click"
                                                           Content="{Binding SettingActionText}"
                                                           Margin="0,0,4,0"
                                                           Padding="8,4"
                                                           FontSize="12"
                                                           ToolTip="{Binding SettingActionText}">
                                                        <Button.Style>
                                                            <Style TargetType="Button" BasedOn="{StaticResource SecondaryButton}">
                                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding HasSettingAction}" Value="True">
                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>

                                                    <!-- 卸载按钮 -->
                                                    <Button Click="Button_UninstallPlugin_Click"
                                                           Content="{Binding UninstallActionText}"
                                                           Padding="8,4"
                                                           FontSize="12"
                                                           ToolTip="{Binding UninstallActionText}">
                                                        <Button.Style>
                                                            <Style TargetType="Button" BasedOn="{StaticResource SecondaryButton}">
                                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                                <Setter Property="Foreground" Value="#E53E3E"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsLocal}" Value="True">
                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>

                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>
                    </Grid>
                </Border>
            </TabItem>
        </TabControl>
    </Grid>
</Window>